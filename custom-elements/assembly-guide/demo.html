<html>
  <head>
    <title>Assembly guide viewer example</title>
      <script src="../../components/platform/platform.js"></script>
      <link rel="import" href="../tween-js/tween-js.html">
      <link rel="import" href="../../components/polymer-three-js/three-js.html">
      <link rel="import" href="../visual-helpers/visual-helpers.html">
      <link rel="import" href="../usco-base-ui/usco-iconsets.html">

<link rel="import" href="../../components/core-icon-button/core-icon-button.html">
<link rel="import" href="../../components/core-menu-button/core-menu-button.html">
<link rel="import" href="../../components/core-tooltip/core-tooltip.html">
<link rel="import" href="../../components/core-item/core-item.html">
<link rel="import" href="../../components/core-transition/core-transition.html">

<link rel="import" href="assembly-viewer.html">
<link rel="import" href="assembly-step.html">

      <style>
         html, body, three-js, assembly-viewer{
      margin: 0;
      position: absolute;
      height: 100%;
      width:100%;
      
      -webkit-touch-callout: none;
		-webkit-user-select: none;
		-khtml-user-select: none;
		-moz-user-select: none;
		-ms-user-select: none;
		user-select: none;
    }
     #perspectiveView{
        position: absolute;
        width: 100%;
        height: 100%;
        left: 0;
        z-index:1;
      }
      </style>
  </head>
<body>
  <!--Experimental-->
  
  
  <assembly-viewer></assembly-viewer>

  <script>
      window.addEventListener('polymer-ready', function() {
        console.log("web components ready");

        //Exploring data structures for build instructions
        //based on tracker.json datastructure from TTN ?
        instructions = {"instructions":[
            {
               "step":1,
               "text":"do some stuff",
               "parts": [
               
               ],
               "logic":"screw #0001 into #0004 at [0,2,3]",
               "images":[
                  "thumbnails/..."
               ]
            },
            {
               "step":2,
               "text":"",
               "images":[
                  "thumbnails/..."
               ]
            }
         ]};

        //TODO: branching and conditionals ?
        //TODO: what is the best way to define what goes where ? 
        /* ie : bolt M3 L 10 into HOle 1 ?
        
        //steps:
        //stop animations
        //load animation data
        //load models
        
        /* assembly instructions are a tree, with depth first assembly ("smallest"/leaves first);
        assembly steps would need to contribute to an existing hierarchy, existing outside of them
        */
        
        
        assemblyTest = [
           {
            name:"3DR-TIKI",
            position:[0,0,0],
            rotation:[0,0,0],
            scale:[1,1,1],
            children:[
             {
              name:"topCorner",
              uri:"demo-data/TopCornerOK.stl",
              position:[0,0,0],
              rotation:[0,0,0],
              scale:[1,1,1],
              children:[
                {
                  name:"mountNut",
                  uri:"demo-data/M3Nut.stl",
                  position:[54,-9,5],
                  rotation:[0,0,0],
                  scale:[1,1,1],
                },
                {
                  name:"mountBolt",
                  uri:"demo-data/M3Bolt_L6.stl",
                  position:[54,9,5],
                  rotation:[0,0,0],
                  scale:[1,1,1],
                },
              ],
              connectors:[
                {name:"foo1",
                 type:"connector",
                 position:[0,0,30],
                 rotation:[0,0,0],
                 scale:[1,1,1],
                 }
              ]
             },
             { name:"bottomCorner",
              uri:"demo-data/BottomCorner.stl",
              position:[0,0,0],
              rotation:[0,0,0],
              scale:[1,1,1],
              children:[
                {
                  name:"mountNut",
                  uri:"demo-data/M3Nut.stl",
                  position:[54,-9,5],
                  rotation:[0,0,0],
                  scale:[1,1,1],
                },
                {
                  name:"mountBolt",
                  uri:"demo-data/M3Bolt_L6.stl",
                  position:[54,9,5],
                  rotation:[0,0,0],
                  scale:[1,1,1],
                },
              ],
             }
           ]
           }
        ];
        
        finalAssembly = [
          {
            name:"BottomCorner",
            uri:"demo-data/BottomCorner.stl",
            position:[0,0,0],
            rotation:[0,0,0],
            scale:[1,1,1],
            children:[
               {name:"motorBolt0",
               type:"bolt",
               uri:"demo-data/Bolt.stl",
               connectedTo:"foo1"
               },
               {name:"motorBolt1",
               type:"bolt",
               uri:"demo-data/Bolt.stl",
               connectedTo:"foo1"
               },
               {name:"motorBolt2",
               type:"bolt",
               uri:"demo-data/Bolt.stl",
               connectedTo:"foo1"
               },
               {name:"motorBolt3",
               type:"bolt",
               uri:"demo-data/Bolt.stl",
               connectedTo:"foo1"
               }
            ],
            connectors:[
              {name:"foo1",
               type:"connector",
               position:[0,0,30],
               rotation:[0,0,0],
               scale:[1,1,1],
               }
            ]
           }
        ];

	      var assemblyViewer = document.querySelector('assembly-viewer');
	      assemblyViewer.instructions = instructions;
	      assemblyViewer.assembly = assemblyTest;
     
        
    });
  </script>  
</body>
</html>
