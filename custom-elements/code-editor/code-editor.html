<link rel="import" href="../../components/polymer/polymer.html">
<link rel="import" href="../../components/polymer-signals/polymer-signals.html">

<link rel="import" href="../../components/code-mirror/code-mirror.html">

<polymer-element name="code-editor" attributes="theme mode value" >
  <template>
    <style>
          code-mirror{position:absolute;top:120px;right:20px;width:400px;height:150px;z-index:9999;}
    </style>
  
    <code-mirror id="innerEditor" theme="{{theme}}" mode="{{mode}}" value="{{value}}" cursorPos="{{cursorLocation}}"> </code-mirror>
  </template>
  <script>
  Polymer("code-editor",{
    theme:"monokai",
    mode:"javascript",
    value:"",
    cursorLocation : null,
    enteredView:function()
    {
      this.innerEditor = this.$.innerEditor;
    },
    cursorLocationChanged:function()
    {
      this.asyncFire('polymer-signal', {name: "request-highlight-from-code", data:{location:this.cursorLocation}});
      //this.highlightSelectionsFromCode();
    },
    clearMarkers:function()
    {
      this.innerEditor.clearMarkers();
    },
    addMarker:function(line)
    {
      this.innerEditor.addMarker( line );
    },
    positionFromIndex:function( index )
    {
      return this.innerEditor.mirror.posFromIndex( index );
    }

  });
  </script>
</polymer-element>  
