<link rel="import" href="../../components/polymer/polymer.html">

<link rel="import" href="../visual-editor/visual-editor.html">

<link rel="import" href="../../components/usco-client-deps/usco-client-deps.html">

<link rel="import" href="../../components/usco-asset-manager/usco-asset-manager.html">

<link rel="import" href="../../components/usco-xhr-store/xhr-store.html">
<link rel="import" href="../../components/usco-desktop-store/desktop-store.html">
<!--<link rel="import" href="../../components/usco-dropbox-store/dropbox-store.html">
<link rel="import" href="../../components/usco-fs-store/fs-store.html">-->

<link rel="import" href="../../components/usco-amf-serializer/amf-serializer.html">
<link rel="import" href="../../components/usco-stl-serializer/stl-serializer.html">
<link rel="import" href="../../components/usco-obj-serializer/obj-serializer.html">

<link rel="import" href="../../components/usco-amf-parser/amf-parser.html">
<link rel="import" href="../../components/usco-stl-parser/stl-parser.html">
<link rel="import" href="../../components/usco-obj-parser/obj-parser.html">
<link rel="import" href="../../components/usco-ply-parser/ply-parser.html">
<link rel="import" href="../../components/usco-ctm-parser/ctm-parser.html">


<polymer-element name="usco-editor">
<template>
  <style>
    visual-editor{
      width:100%;
      height:100%;
    
    }
  </style>
  <usco-client-deps> </usco-client-deps>
  
  <visual-editor> </visual-editor>
  <!--<code-editor> </code-editor>-->
  <!--<code-mirror id="selectEdit" theme="monokai" mode="javascript" value="{{source}}" boundValue="{{altSource}}" >
    </code-mirror>-->
  
  <history-editor id="historyEditor"> </history-editor>
    <!--<drag-drop id="dragDropLayer"> </drag-drop>-->
    
  <!--various helpers: TODO:refactor-->
  <div id="codeGen" class="codeGen" style="position:absolute; right:10px;top:30px;z-index:3">
    <button on-click="{{generateCodeFromHistory}}"> Generate code from history </button>
    <button on-click="{{generateFromCode}}"> Generate shapes from code </button>
  </div>
  
  <usco-asset-manager>
    <xhr-store> </xhr-store>
    <desktop-store> </desktop-store>
    <dropbox-store> </dropbox-store>
    <fs-store> </fs-store>

    <amf-serializer> </amf-serializer>
    <stl-serializer> </stl-serializer>
    <obj-serializer> </obj-serializer>

    <amf-parser> </amf-parser>
    <stl-parser> </stl-parser>
    <obj-parser> </obj-parser>
    <ply-parser> </ply-parser>
    <ctm-parser> </ctm-parser>
  </usco-asset-manager>
  
</template>
<script>
Polymer("usco-editor",{

  //generation of code based on history
  generateCodeFromHistory:function()
  {
     console.log("generating code from history");
     this.source = updateSelectionCode(this.selectedObject,this.commandManager.undos);
     console.log("res source", this.source);
  },
  generateFromCode:function()
  {
    console.log("generating from code",this.altSource);
    
    var result = eval(this.altSource)
    console.log("result", result);
  },

});
</script>
</polymer-element>
