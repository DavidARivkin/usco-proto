<polymer-element name="drag-drop"
on-dragenter="{{handleDragEnter}}" on-dragover="{{handleDragOver}}"
on-dragleave="{{handleDragLeave}}" on-drop="{{handleDrop}}" 
>
<template>
  <style>

  </style>
</template>
<script>
Polymer("drag-drop",{

handleDragOver:function(e) {
    if (e.preventDefault) {
      e.preventDefault();
    }
    console.log("drag over")
  },
  handleDragEnter:function(e) {
    console.log("drag enter")
  },
  handleDragLeave:function(e) {
    console.log("drag leave")
  },
  handleDrop:function(e) {
     if (e.preventDefault) {
      e.preventDefault(); // Necessary. Allows us to drop.
    }
    var data=e.dataTransfer.getData("Text");
    console.log("data",data)
    if(data)
    {
      this.loadResource(data);
    }
    
    //we have files (desktop dnd)
    var files = e.dataTransfer.files;
    console.log("files",files);
    if (!(window.File && window.FileReader && window.FileList && window.Blob)) {
      console.log('The File APIs are not fully supported in this browser.');
      //TODO: handle error
    }
    else {
      var self= this;
      for (var i = 0, f; f = files[i]; i++) {
        var reader = new FileReader();
        var fileName = f.name;
        reader.onload = function(e){
          var geometry=  self._assetManager.parsers["stl"].parse(e.target.result);
          var material = new THREE.MeshPhongMaterial( { color: 0x17a9f5, specular: 0xffffff, shininess: 10, shading: THREE.FlatShading} );
          var shape = new THREE.Mesh(geometry, material);
          self.addToScene(shape);
        }

        reader.onprogress = function(e){
          if (e.lengthComputable) {
            var percentage = Math.round((e.loaded * 100) / e.total);
            console.log( 'Loaded : '+percentage+'%'+' of '+fileName);
          }  
        }
        reader.readAsBinaryString(f);
      }
    }
  },

});
</script>
</polymer-element>
